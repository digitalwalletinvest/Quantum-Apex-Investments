<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Profile ‚Äì Quantum Apex</title>

<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js"></script>
<script src="https://cdn.tailwindcss.com"></script>

<style>
body{
  margin:0;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  background:radial-gradient(circle at top, #1e293b, #020617);
  font-family:Inter,system-ui,sans-serif;
  color:#e5e7eb;
  overflow:hidden;
}

/* Compact Card */
.container{
  width:100%;
  max-width:360px;
  padding:1.6rem 1.5rem;
  background:linear-gradient(180deg,#020617,#020617cc);
  border-radius:18px;
  border:1px solid #1f2937;
  box-shadow:
    0 15px 35px rgba(0,0,0,.7),
    inset 0 1px 0 rgba(255,255,255,.03);
}

/* Header */
.head-icon{
  font-size:2.5rem;
  text-align:center;
  margin-bottom:.2rem;
}
.profile-title{
  text-align:center;
  font-size:1.6rem;
  font-weight:800;
  color:#10b981;
  letter-spacing:.3px;
  margin-bottom:1.5rem;
}

/* Fields */
.field-wrapper{
  position:relative;
  margin-bottom:1rem;
}
label{
  display:block;
  font-size:.75rem;
  font-weight:600;
  letter-spacing:.3px;
  color:#94a3b8;
  margin-bottom:.3rem;
  text-transform:uppercase;
}
input{
  width:100%;
  height:40px;
  padding:0 .8rem;
  border-radius:12px;
  background:#020617;
  border:1px solid #334155;
  color:#f9fafb;
  font-size:.95rem;
  transition:border .2s, box-shadow .2s;
}
input:focus{
  outline:none;
  border-color:#10b981;
  box-shadow:0 0 0 2px rgba(16,185,129,.15);
}
input[disabled]{ background:#020617; color:#9ca3af; }

/* Edit icon */
.edit-icon{
  position:absolute;
  right:12px;
  top:50%;
  transform:translateY(-50%);
  cursor:pointer;
  color:#10b981;
  font-size:1rem;
  opacity:.75;
}
.edit-icon:hover{opacity:1}

/* Divider */
.action-divider{
  height:1px;
  width:100%;
  background:linear-gradient(to right, transparent, #1f2937, transparent);
  margin:1.5rem 0 1rem;
}

/* Buttons */
button{
  height:42px;
  width:100%;
  border-radius:12px;
  font-weight:700;
  letter-spacing:.3px;
  font-size:.9rem;
  transition:all .25s ease;
}
#saveBtn{
  background:linear-gradient(135deg,#10b981,#059669);
  color:#ecfdf5;
  box-shadow:0 8px 18px rgba(16,185,129,.25);
}
#saveBtn:hover{
  transform:translateY(-1px);
  box-shadow:0 12px 24px rgba(16,185,129,.35);
}
#logout{
  margin-top:.8rem;
  background:transparent;
  border:1px solid #374151;
  color:#9ca3af;
}
#logout:hover{
  border-color:#ef4444;
  color:#ef4444;
}

/* Toast */
.toast{
  position:fixed;
  bottom:1.5rem;
  left:50%;
  transform:translateX(-50%);
  background:#020617;
  padding:12px 24px;
  border-radius:12px;
  box-shadow:0 15px 30px rgba(0,0,0,.7);
  display:none;
  font-weight:700;
  letter-spacing:.3px;
  z-index:1000;
}
</style>
</head>

<body>

<div class="container">
  <div class="head-icon">üó£Ô∏è</div>
  <div class="profile-title">Account Profile</div>

  <div class="field-wrapper">
    <label>Account ID</label>
    <input id="accountId" disabled>
  </div>

  <div class="field-wrapper">
    <label>Full Name</label>
    <input id="name" disabled>
    <span class="edit-icon" id="editName">‚úé</span>
  </div>

  <div class="field-wrapper">
    <label>Email Address</label>
    <input id="email" disabled>
  </div>

  <div class="field-wrapper">
    <label>Phone Number</label>
    <input id="phone" disabled>
    <span class="edit-icon" id="editPhone">‚úé</span>
  </div>

  <div class="field-wrapper">
    <label>Country</label>
    <input id="country" disabled>
  </div>

  <div class="action-divider"></div>

  <button id="saveBtn">Save Changes</button>
  <button id="logout">Sign Out</button>
</div>

<div id="toast" class="toast"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
import { getDatabase, ref, onValue, update } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

const app = initializeApp({
  apiKey:"AIzaSyDaEphuY2kQue8m-20DDs68JDgQirAycBE",
  authDomain:"digital-wallet-40297.firebaseapp.com",
  databaseURL:"https://digital-wallet-40297-default-rtdb.europe-west1.firebasedatabase.app",
  projectId:"digital-wallet-40297"
});

const auth = getAuth(app);
const db = getDatabase(app);

const accountId = document.getElementById("accountId");
const name = document.getElementById("name");
const email = document.getElementById("email");
const phone = document.getElementById("phone");
const country = document.getElementById("country");
const toast = document.getElementById("toast");

editName.onclick = () => { name.disabled=false; name.focus(); };
editPhone.onclick = () => { phone.disabled=false; phone.focus(); };

function showToast(msg, ok=true){
  toast.innerText = msg;
  toast.style.display="block";
  toast.style.color = ok ? "#10b981" : "#ef4444";
  setTimeout(()=>toast.style.display="none",3000);
}

function generateAccountId(uid){ return "QA-" + uid.slice(-6).toUpperCase(); }

let userRef;
onAuthStateChanged(auth,user=>{
  if(!user) location.href="login.html";
  userRef = ref(db,"users/"+user.uid);

  onValue(userRef,snap=>{
    if(!snap.exists()) return;
    const d = snap.val();

    if(!d.accountId){
      const id=generateAccountId(user.uid);
      update(userRef,{accountId:id});
      accountId.value=id;
    } else accountId.value=d.accountId;

    name.value=d.name||"";
    email.value=d.email||"";
    phone.value=d.phone||"";
    country.value=d.country||"";
  });
});

saveBtn.onclick=()=>{
  const updates={};
  if(!name.disabled) updates.name=name.value.trim();
  if(!phone.disabled) updates.phone=phone.value.trim();

  if(!Object.keys(updates).length){
    showToast("No changes to save",false);
    return;
  }

  update(userRef,updates)
    .then(()=>{
      showToast("Profile updated");
      name.disabled=true;
      phone.disabled=true;
    })
    .catch(()=>showToast("Update failed",false));
};

logout.onclick=()=>signOut(auth).then(()=>location.href="login.html");
</script>

</body>
</html>
